/**
 * @copyright   (C) 2018 Open Source Matters, Inc. <https://www.joomla.org>
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */class JMultiSelect{constructor(t){this.tableEl=t,this.formEl=t.closest("form"),this.rowSelector='tr[class^="row"]',this.boxSelector='input[type="checkbox"][name="cid[]"]',this.checkallToggle=this.tableEl.querySelector('[name="checkall-toggle"]'),this.prevRow=null,this.tableEl.addEventListener("click",c=>{c.target.closest(this.rowSelector)&&this.onRowClick(c)}),this.checkallToggle&&this.checkallToggle.addEventListener("click",({target:c})=>{const e=c.checked;this.getRows().forEach(o=>{this.changeBg(o,e)})})}getRows(){return Array.from(this.tableEl.querySelectorAll(this.rowSelector))}changeBg(t,c){t.classList.toggle("row-selected",c)}onRowClick({target:t,shiftKey:c}){if(t.closest("a, button, input, select, textarea, details, dialog, audio, video"))return;const e=t.closest(this.rowSelector),o=t.matches(this.boxSelector)?t:e.querySelector(this.boxSelector);if(!o)return;const s=o!==t?!o.checked:o.checked;if(s!==o.checked&&(o.checked=s,Joomla.isChecked(s,this.formEl)),this.changeBg(e,s),c&&this.prevRow){document.getSelection().removeAllRanges();const h=this.getRows(),l=h.indexOf(this.prevRow),i=h.indexOf(e);l>=0&&i>=0&&Math.abs(l-i)>1&&(l<i?h.slice(l,i+1):h.slice(i,l+1)).forEach(n=>{if(n===e)return;const a=n.querySelector(this.boxSelector);a&&a.checked!==s&&(a.checked=s,this.changeBg(n,s),Joomla.isChecked(s,this.formEl))})}this.prevRow=e}}const onBoot=r=>{let t="#adminForm";const c=window.Joomla?Joomla.getOptions("js-multiselect",{}).formName:"";if(c){const e=c[0];t=e!=="."&&e!=="#"?`#${c}`:c}r.querySelectorAll(t).forEach(e=>{e&&!("multiselect"in e.dataset)&&(e.dataset.multiselect="",new JMultiSelect(e))})};onBoot(document),document.addEventListener("joomla:updated",({target:r})=>onBoot(r));
